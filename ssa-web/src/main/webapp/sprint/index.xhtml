<?xml version="1.0" encoding="ISO-8859-1" ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    template="/template.xhtml"
    xmlns:c="http://java.sun.com/jsp/jstl/core">

    <ui:define name="content">
        <h1>Sprint Backlog <small>Listado de sprints del proyecto</small></h1>
        <div class="row">
            <div class="span8">
                <h:form>
                    <p>
                        <p:dataTable value="#{sprintManager.sprints}" var="sprint" paginator="true" paginatorPosition="bottom" rows="14" emptyMessage="No hay ningun sprint asociado al proyecto actual">
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="id" />
                                </f:facet>
                                <h:outputText value="#{sprint.id}" />
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="Tasks"/>
                                </f:facet>
                                <h:outputText value="#{sprint.tasks.size()}"/>
                            </p:column>
                            <p:column sortBy="#{sprint.created}">
                                <f:facet name="header">
                                    <h:outputText value="Created" />
                                </f:facet>
                                <h:outputText value="#{sprint.created}" >
                                    <f:convertDateTime pattern="d/M/yyyy"/>
                                </h:outputText>

                            </p:column>
                            <p:column sortBy="#{sprint.beginDate}">
                                <f:facet name="header">
                                    <h:outputText value="Start" />
                                </f:facet>
                                <h:outputText value="#{sprint.beginDate}" >
                                    <f:convertDateTime pattern="d/M/yyyy"/>
                                </h:outputText>
                            </p:column>
                            <p:column sortBy="#{sprint.endDate}">
                                <f:facet name="header">
                                    <h:outputText value="Finish" />
                                </f:facet>
                                <h:outputText value="#{sprint.endDate}" >
                                    <f:convertDateTime pattern="d/M/yyyy"/>
                                </h:outputText>
                            </p:column>
                            <p:column >
                                <f:facet name="header">
                                    <h:outputText value="Summary" />
                                </f:facet>
                                <h:commandLink value="#{sprint.summary}" action="#{sprintManager.edit}" />
                            </p:column>
                        </p:dataTable>
                    </p>
                    <p>
                        <p:commandButton  action="#{sprintManager.create}" value="New Sprint" styleClass="btn" update="@form"/>
                    </p>
                </h:form>
            </div>

            <div class="span4">
                <h3>Burndown Chart</h3>
                <p> Representaci&oacute;n del Story Points asociado a cada Sprint del proyecto <code> #{projectManager.currentProject.name}</code>                    
                </p>
                <h:form>
                    <c:choose>
                        <c:when test="#{statisticsBean.maxValueBarModel>0}">
                            <p:barChart id="basic" value="#{statisticsBean.storyPointBarModel}" legendPosition="ne"  
                                title="Story point del Sprint" min="0" max="#{statisticsBean.maxValueBarModel}"  style="width:300px;height:300px;margin-top:20px;"/>
                        </c:when>
                        <c:otherwise>
                            <h:outputLabel value="Insuficiente informaci&oacute;n para representar"  style="color:#da4f49"/>
                        </c:otherwise>
                    </c:choose>
                </h:form>

            </div>
        </div>
    </ui:define>
</ui:composition>
