<?xml version="1.0" encoding="ISO-8859-1" ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    template="/template.xhtml">

    <ui:define name="content">
		<style> .ui-datatable input.ui-column-filter { display: inline-block; padding: 0; margin-left: 10px; } </style>
		<h1>BackLog <small>Listado de tareas del proyecto</small></h1>
        <div class="row">
            <div class="span8" style="position: relative">
				<h:form style="position: absolute; right: 0px;top: -34px;">
					<h:commandButton  action="#{taskManager.create}" value="Crear nueva tarea" styleClass="btn btn-success" />
				</h:form>
                <h:form id="task_list_form">
					<p:dataTable value="#{taskManager.tasks}" var="task" 
								 paginator="true" paginatorPosition="bottom" rows="15" emptyMessage="No hay tareas">

						<p:column>
							<f:facet name="header">
								<h:outputText value="id" />
							</f:facet>
							<h:outputText value="#{task.id}" />
						</p:column>

						<p:column sortBy="#{task.status}" >
							<f:facet name="header">
								<h:outputText value="Status&nbsp;&nbsp;"/>
							</f:facet>
							<h:outputText value="#{task.status}"/>
						</p:column>
						<p:column>
							<f:facet name="header">
								<h:outputText value="User&nbsp;&nbsp;"/>
							</f:facet>
							<h:outputText value="#{task.user.nickname}"/>
						</p:column>
						<p:column  headerText="Priority&nbsp;&nbsp;"  sortBy="#{task.priority}" >
							<h:outputText value="#{task.priority}"  />
						</p:column>
						<p:column sortBy="#{task.created}">
							<f:facet name="header">
								<h:outputText value="Created" />
							</f:facet>
							<h:outputText value="#{task.created}" >
								<f:convertDateTime pattern="d/M/yyyy"/>
							</h:outputText>
						</p:column>
						<p:column filterBy="#{task.summary}" sortBy="#{task.summary}">
							<f:facet name="header">
								<h:outputText value="Summary" />
							</f:facet>
							<h:commandLink value="#{task.summary}" action="#{taskManager.edit}" />
						</p:column>
					</p:dataTable>
                </h:form>
            </div>
            <div class="span4">
                <h3>Estad&iacute;stico de tareas </h3>
                <p> En el gr&aacute;fico circular representa de forma porcentual el n&uacute;mero de
					tareas, contenidas en el proyecto <code> #{projectManager.currentProject.name}
					</code>, agrupadas seg&uacute;n su estado.
					<h6 style="text-align: center">N&uacute;mero de tareas/Estado de la tarea</h6>
					<p:pieChart id="sample" value="#{statisticsBean.pieTaskModel}" style="width:300px;height:300px" />
				</p>
            </div>
        </div>
    </ui:define>
</ui:composition>
