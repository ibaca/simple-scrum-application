<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:c="http://java.sun.com/jsp/jstl/core">
    <h:head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<h:outputStylesheet name="css/bootstrap.css" value="#{param.location}" />
		<h:outputScript name="js/bootstrap.js" value="#{param.location}" />
		<h:outputScript name="js/bootstrap-dropdown.js" value="#{param.location}" />
		
		<style>
			.ui-dt-c { white-space: nowrap; }
		</style>

		<ui:insert name="htmlHead" />

    </h:head>

    <h:body style="font-size:10px;padding-top: 60px;padding-bottom: 40px;">


		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<!-- topbar -->
					<c:if test="#{userManager.authenticated}">
						<h:form>   
							<h:commandLink value="#{ empty projectManager.currentProject.name ? 'Simple Scrum Application' : projectManager.currentProject.name}" action="/index.jsf" class="brand" />
							<ul class="nav">
								<li><h:commandLink value="Home" action="/project/home" /></li>
								<li><h:commandLink value="Tareas" action="/task/index" /></li>
								<li><h:commandLink value="Sprints" action="/sprint/index" /></li>
								<li><h:commandLink value="Administrar" action="/project/edit.xhtml" /></li>
							</ul>
							<ul class="nav pull-right">
								<li>Hola #{userManager.currentUser.email}!</li>
								<li id="projects-dropdown" class="dropdown">
									<a class="dropdown-toggle" data-toggle="dropdown" href="#projects-dropdown">Projectos<b class="caret"></b></a>
									<ul class="dropdown-menu">
										<c:forEach items="#{userManager.currentUser.projects}" var="project">
											<li><h:commandLink value="#{project.name}" action="#{projectManager.changeCurrentProject(project)}" /></li>
										</c:forEach>
										<li class="divider"></li>
										<li><h:commandLink action="#{projectManager.create}" value="Nuevo proyecto" /></li>
									</ul>
									<!-- al ser asincrono no inicializa el dropdown -->
									<script>$('.dropdown-toggle').dropdown()</script>
								</li>
								<li><p:commandLink value="Settings" url="#" /></li>
								<li><h:commandLink value="Logout" action="#{userManager.logout()}" /></li>
							</ul>
						</h:form> 
					</c:if>
					<c:if test="#{!userManager.authenticated}">
						<h:form>   
							<h:commandLink value="Simple Scrum Application" action="/index.jsf" class="brand" />
							<ul class="nav">
								<li><a>Project</a></li>
							</ul>
							<ul class="nav pull-right">
								<li><a>Settings</a></li>
								<li><h:commandLink value="Login" action="/login.jsf" /></li>
							</ul>
						</h:form> 
					</c:if>
				</div>
			</div>
		</div>

		<div class="container">
			<c:if test="false">
				<div>
					<div class="thumbnail" style="width:60px;float:left;"><img alt="#{projectManager.currentProject.summary}" src="http://www.gravatar.com/avatar/00000000000000000000000000000000?default=retro"></img></div>
					<h1>#{projectManager.currentProject.name}</h1>
					<h2><small>#{projectManager.currentProject.summary}</small></h2>
				</div>
			</c:if>


			<!-- Content -->
			<ui:insert id="content" name="content"></ui:insert>

			<hr />

			<!-- Footer -->
			<footer>
				<p>Â© Inftel 2012 | Hello #{userManager.currentUser.nickname}, #{userManager.currentUser.email}</p>
			</footer>
		</div>

		<p:growl id="growl" showDetail="true" globalOnly="true" />

    </h:body>
</html>
